<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="dataServerIntro_files/filelist.xml">
<title>Data Server Client Introduction</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>nnl</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>nnl</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>165</o:TotalTime>
  <o:Created>2004-04-28T18:10:00Z</o:Created>
  <o:LastSaved>2004-04-28T18:33:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>304</o:Words>
  <o:Characters>1733</o:Characters>
  <o:Company>ornl</o:Company>
  <o:Lines>14</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2033</o:CharactersWithSpaces>
  <o:Version>10.4219</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:26026257;
	mso-list-type:hybrid;
	mso-list-template-ids:-1871658380 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:809201918;
	mso-list-template-ids:182885390;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>EPICS Data Server Introduction<o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal>It is often desirable to provide the HRIBF operators with
various types of<span style='mso-spacerun:yes'>  </span>diagnostic information
related to the delivery of beam to a target associated with some experiment. In
the past, custom applications have supplied this information using X Windows as
the delivery mechanism.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Another method now exists that can be used by an external
agent to write directly into an EPICS database. The supplied information may
thus be easily integrated into the control system displays according to the
preferences of the operators.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>Servers</span></b><span style='font-size:18.0pt'><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Six servers are available on orib51. Each server may
handle only one connection at a time so, currently, only six clients may be
run at any point in time. A client connects to a server with a unique port.
Available ports are 60000, 60001, 60002, 60003, 60004, and 60005.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>Clients<o:p></o:p></span></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Clients include dataServer.h and use routines contained in
dslib.c to communicate with a server. The general structure of a client is
given below.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'>Call
dsInit to connect to a server<br>
<br>
Call dsAllocatePvs to allocate list of N EPICS PVs for write access<br>
<br>
loop {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:.75in'><span style='font-family:Courier'>Obtain
N numeric diagnostic values<br>
<br>
Encode these numeric values as a character string<br>
<br>
call dsWriteAll to write EPICS PVs<br>
<br>
call dsDelay to delay<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.75in'><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'>}
until finished<br>
<br>
call dsFreePvs to free the list of allocated PVs<br>
<br>
call dsTerminate to close the connection with the server<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>EPICS PV Names<o:p></o:p></span></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Legal PV names must conform to one of the following forms:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-left:27.0pt'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Courier'>
scal:acq1:cnt#<br>
scal:acq2:cnt#<br>
scal:acq3:cnt#<br>
<br>
scal:rmsacq1:cnt#<br>
scal:rmsacq2:cnt#<br>
scal:rmsacq3:cnt#<br>
<br>
scal:drsacq1:cnt#<br>
scal:drsacq2:cnt#<br>
scal:drsacq3:cnt#<br>
<br>
# may be 0 through 9<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>Using any other name will result in an error.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>Building Your Client<o:p></o:p></span></b></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l0 level1 lfo3;tab-stops:list .5in'>Obtain
     dslib.c, dataServerPriv.h, dataServer.h, and dataServer.version</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo3;tab-stops:list .5in'>Write
     the code for your client, see client.c as an example</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo3;tab-stops:list .5in'>Modify
     the makefile shown below; change <i style='mso-bidi-font-style:normal'>client</i>,
     <i style='mso-bidi-font-style:normal'>client.c</i>, and <i
     style='mso-bidi-font-style:normal'>client.o</i> to the name of your client
     files</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo3;tab-stops:list .5in'>make</li>
</ul>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'>Example Make File<o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-size:18.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'>client
: client.o dslib.o<br>
<span style='mso-spacerun:yes'>        </span>cc –o client –lm client.o dslib.o<br>
<br>
client.o : client.c dataServer.h<br>
<span style='mso-spacerun:yes'>        </span>cc –o client.o –c client.c<br>
<br>
dslib.o : dslib.c dataServerPriv.h \<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:27.0pt'><span style='font-family:Courier'><span
style='mso-spacerun:yes'>          </span>dataServer.h dataServer.version<br>
<span style='mso-spacerun:yes'>        </span>cc –o dslib.o –c dslib.c<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
