C$PROG FUNKY     - Function generator for linear fitting
C
C     ******************************************************************
C     BY W.T. MILNER AT HRIBF - LAST MODIFIED 06/30/2000
C     ******************************************************************
C
      REAL*8 FUNCTION FUNKY(X,NDX)
C
      IMPLICIT REAL*8 (A-H,O-Z)
C
C     ------------------------------------------------------------------
      COMMON/FT04/ ITSP(20),KINT(20),NTERMS
      INTEGER*4    ITSP,    KINT,    NTERMS
C     ------------------------------------------------------------------
      DIMENSION    XTSP(20)
C
      EQUIVALENCE (ITSP(1),XTSP(1))
C     ------------------------------------------------------------------
C
C     ------------------------------------------------------------------
C     RETURNS TERM VALUE AS FUNCTION OF X AND NDX
C     ------------------------------------------------------------------
C
      KIND=KINT(NDX)
C
      GO TO (100,200,300),KIND
C
C     ------------------------------------------------------------------
C     POWER SERIES TERMS
C     ------------------------------------------------------------------
C
  100 EX=XTSP(NDX)
      FUNKY=X**EX
      RETURN
C
C     ------------------------------------------------------------------
C     LEGENDRE POLYNOMIAL TERMS
C     ------------------------------------------------------------------
C
  200 N=ITSP(NDX)
      FUNKY=PL(N,X)
      RETURN
C
C     ------------------------------------------------------------------
C     CONSTANT TERMS 
C     ------------------------------------------------------------------
C
  300 FUNKY=1.0
      RETURN
      END
