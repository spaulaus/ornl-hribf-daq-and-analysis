C$PROG STOPXNIT  - Initializing routine for program stopo
C
C
C     ******************************************************************
C     BY T.C. Awes at HHIRF - LAST MODIFIED by W.T. Milner 04/25/2002
C     ******************************************************************
C
      SUBROUTINE STOPXNIT
C
      IMPLICIT NONE
C
C     ------------------------------------------------------------------
      COMMON/LLL/ MSSG(28),NAMPROG(2),LOGUT,LOGUP,LISFLG,MSGF
      INTEGER*4   MSSG,NAMPROG,LOGUT,LOGUP
      CHARACTER*4 LISFLG,MSGF
      CHARACTER*112 CMSSG
      EQUIVALENCE (CMSSG,MSSG)
C     ------------------------------------------------------------------
      COMMON/ML01/ IWD(20),LWD(2,40),ITYP(40),NF,NTER
      INTEGER*4    IWD,    LWD,      ITYP,    NF,NTER
C     ------------------------------------------------------------------
      COMMON/HEP/  IHEPF
      CHARACTER*4  IHEPF
C     ------------------------------------------------------------------
      INTEGER*4    I
C     ==================================================================
      COMMON/STX02/   IM,IP,IE
      INTEGER*4       IM,IP,IE
C
      DATA            IM,IP,IE/0,0,0/
C     ------------------------------------------------------------------
      COMMON/STX04/   IFILE, DEP
      LOGICAL         IFILE
      REAL*4                 DEP
      DATA            IFILE/.FALSE./
C     ------------------------------------------------------------------
      COMMON/STX05/   IDIV
      LOGICAL         IDIV
      DATA            IDIV/.FALSE./
C     ==================================================================
      COMMON/SYMBOL/  BLNK,PNT,GASS,MNS,NUCN(105),ICHR(5)
      INTEGER*4       BLNK,PNT,GASS,MNS,NUCN,     ICHR
C
      CHARACTER*60    CNUCN(7)
      EQUIVALENCE    (CNUCN,NUCN)
C
      DATA            BLNK/Z'00000020'/
      DATA            PNT /Z'0000002E'/
      character*4     cGASS
      equivalence    (cGASS, GASS)
      DATA           cGASS/'GAS '/
      DATA            MNS /'0000002D'X/
C     ------------------------------------------------------------------
      DATA            ICHR(1)/Z'0000002A'/    ! *
      DATA            ICHR(2)/Z'0000002B'/    ! +
      DATA            ICHR(3)/Z'00000028'/    ! (
      DATA            ICHR(4)/Z'00000029'/    ! )
      DATA            ICHR(5)/Z'0000002C'/    ! ,
C     ------------------------------------------------------------------
      DATA CNUCN/
     1 'H   HE  LI  BE  B   C   N   O   F   NE  NA  MG  AL  SI  P   '
     2,'S   CL  AR  K   CA  SC  TI  V   CR  MN  FE  CO  NI  CU  ZN  '
     3,'GA  GE  AS  SE  BR  KR  RB  SR  Y   ZR  NB  MO  TC  RU  RH  '
     4,'PD  AG  CD  IN  SN  SB  TE  I   XE  CS  BA  LA  CE  PR  ND  '
     5,'PM  SM  EU  GD  TB  DY  HO  ER  TM  YB  LU  HF  TA  W   RE  '
     6,'OS  IR  PT  AU  HG  TL  PB  BI  PO  AT  RN  FR  RA  AC  TH  '
     7,'PA  U   NP  PU  AM  CM  BK  CF  ES  FM                      '/
C     ------------------------------------------------------------------
      COMMON/ABSS/    AZ(5,10),AA(5,10),INUM(5,10),IKEY(5,10),
     &                FRACT(5,10),NCOM(10),PRES(10),THCK(10),IONZ(10)
C
      REAL*4          AZ,AA,FRACT,PRES,THCK,IONZ
C
      INTEGER*4       INUM,IKEY,NCOM
C     ------------------------------------------------------------------
      COMMON/PROJ/    PZ(100),PA(100),EP(500)
      REAL*4          PZ,     PA,     EP
C     ------------------------------------------------------------------
C
C     CALCULATION VARIABLES.
C
C     ------------------------------------------------------------------
      COMMON/ARRAYS/  ION(92), IONGS(92), C2S(92),
     &                A0S(10), A1S(10),   A2S(10), A3S(10), A4S(10)
C
      REAL*4          ION,     IONGS,     C2S,
     &                A0S,     A1S,       A2S,     A3S,     A4S
C     ------------------------------------------------------------------
      COMMON/CONSTANT/TMC2, PI, E4, CON(92), DENSITY(92)
      REAL*4          TMC2, PI, E4, CON,     DENSITY
C     ------------------------------------------------------------------
      COMMON/CONTROL/ ISW1,ISW2,ISW3,ISW4
      INTEGER*4       ISW1,ISW2,ISW3
      LOGICAL                        ISW4
C     ------------------------------------------------------------------
      COMMON/PARTICLE/IZT,IZP,ZT,ZP,AT,AP,SPWRH
      INTEGER*4       IZT,IZP
      REAL*4                  ZT,ZP,AT,AP,SPWRH
C     ------------------------------------------------------------------
      COMMON/RUNGE/   DER,EMIN,E0,DUMY,R0
      REAL*4          DER,EMIN,E0,DUMY
      REAL*8                           R0
C     ------------------------------------------------------------------
      COMMON/STOPPING/IAVE,CFACT,C2,A0,A1,A2,A3,A4
      REAL*4          IAVE,CFACT,C2,A0,A1,A2,A3,A4
C     ------------------------------------------------------------------
C
C     ------------------------------------------------------------------
      DATA ION/17.1,45.2,47.,63.,75.,79.,84.4,104.8,126.4,150.9,
     1 141.,149.,162.,159.,168.9,179.2,187.2,200.,189.4,195.,
     2 215.,228.,237.,257.,275.,284.,304.,314.,330.,323.,
     3 335.4,323.,354.7,343.4,360.5,368.2,349.7,353.3,365.,382.,
     4 391.3,393.,416.2,428.6,436.4,456.,470.,466.,479.,511.8,
     5 491.9,491.3,491.8,489.5,484.8,485.5,493.8,512.7,520.2,540.,
     6 537.,545.9,547.5,567.,577.2,578.,612.2,583.3,629.2,637.,
     7 655.1,662.9,682.,695.,713.6,726.6,743.7,760.,742.,768.4,
     8 764.8,761.,762.9,765.1,761.7,764.2,762.3,760.1,767.9,776.4,
     9 807.,808./
C     ------------------------------------------------------------------
      DATA IONGS/19.,42.,0.,0.,0.,66.2,86.,99.,118.8,135.,
     1 0.,0.,0.,0.,0.,0.,170.3,180.,0.,0.,
     2 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,
     3 0.,0.,0.,0.,339.3,347.,0.,0.,0.,0.,
     4 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,
     5 0.,0.,452.4,459.,0.,0.,0.,0.,0.,0.,
     6 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,
     7 0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,
     8 0.,0.,0.,0.,0.,733.1,0.,0.,0.,0.,
     9 0.,0./
C     ------------------------------------------------------------------
      DATA CON/
     & 1.674,6.647,11.52,14.97,17.95,19.95,23.26,26.57,31.55,33.52,
     1 38.15,40.37,44.80,46.64,51.41,53.24,58.87,66.34,64.89,66.56,
     2 74.62,79.54,84.53,86.34,91.96,92.74,97.85,97.49,105.5,108.6,
     3 115.7,120.5,124.3,131.1,132.6,139.2,141.9,145.5,147.6,151.5,
     4 154.2,159.3,164.3,167.8,170.9,176.6,179.1,186.6,190.6,197.0,
     5 202.2,211.8,210.7,218.0,220.6,228.1,230.6,232.6,233.9,239.4,
     6 244.0,250.0,252.3,261.0,263.8,269.8,273.8,277.6,280.3,287.3,
     7 290.4,296.2,300.5,305.3,309.0,315.7,319.0,324.0,327.1,332.9,
     8 339.2,344.1,347.0,348.6,348.6,368.5,370.1,375.1,376.8,385.1,
     9 383.4,395.3/
C     ------------------------------------------------------------------
      DATA C2S/1.44,1.397,1.6,2.59,2.815,2.989,3.35,3.,2.352,2.199,
     1 2.869,4.293,4.739,4.7,3.647,3.891,5.714,6.5,5.833,6.252,
     2 5.884,5.496,5.055,4.489,3.907,3.963,3.535,4.004,4.175,4.75,
     3 5.697,6.3,6.012,6.656,6.335,7.25,6.429,7.159,7.234,7.603,
     4 7.791,7.248,7.671,6.887,6.677,5.9,6.354,6.554,7.024,7.227,
     5 8.48,7.81,8.716,9.289,8.218,8.911,9.071,8.444,8.219,8.,
     6 7.786,7.58,7.38,7.592,6.996,6.21,5.874,5.706,5.542,5.386,
     7 5.505,5.657,5.329,5.144,5.851,5.704,5.563,5.034,5.46,4.843,
     8 5.311,5.982,6.7,6.928,6.979,6.954,7.82,8.448,8.609,8.679,
     9 8.336,8.204/
C     ------------------------------------------------------------------
      DATA DENSITY/1.,1.,0.5298,1.803,2.351,2.267,1.,1.,1.,1.,
     1 0.9702,1.737,2.699,2.322,1.822,2.069,1.,1.,0.8633,1.341,
     2 2.998,4.52,6.102,7.193,7.435,7.867,8.797,8.897,8.951,7.107,
     3 5.909,5.338,5.72,4.786,3.401,1.,1.529,2.6,4.491,6.471,
     4 8.604,10.21,1.,12.18,12.4,11.96,10.47,8.582,7.315,7.283,
     5 6.618,6.225,4.939,1.,1.899,3.522,6.175,6.673,6.775,7.003,
     6 1.,7.557,5.259,7.903,8.279,8.554,8.821,9.092,9.335,6.979,
     7 9.831,13.13,16.6,19.29,21.04,22.57,22.51,21.44,19.31,13.56,
     8 11.88,11.32,9.813,9.253,1.,1.,1.,5.023,1.,11.66,
     9 15.4,19.05/
C     ------------------------------------------------------------------
      DATA A0S/5.05,4.41,7.65,11.57,14.59,19.07,17.11,15.0,17.8,20.4/
      DATA A1S/2.05,1.88,2.99,4.39,5.46,7.02,6.10,5.15,6.18,6.97/
      DATA A2S/.304,.281,.419,.598,.733,.931,.778,.626,.766,.874/
      DATA A3S/.020,.018,.025,.035,.042,.053,.043,.032,.041,.048/
      DATA A4S/4.7,4.2,5.5,7.5,9.0,11.2,8.6,6.0,7.9,9.5/
C
      DATA TMC2,PI,E4/1.02195,3.14159,2.074E-05/
      DATA ISW1,ISW2,ISW3,ISW4/0,0,0,.FALSE./
      DATA EMIN/1./
C
      character*4 cnamprog(2)
      equivalence (cnamprog, namprog)
      DATA cNAMPROG/'STOP','X   '/
C
C     ==================================================================
C
      SAVE
C
C     ==================================================================
C
      CMSSG=' '
      MSGF='    '
      LISFLG='LON '
      LOGUT=6
      LOGUP=7
C
      OPEN(UNIT       = LOGUP,
     &     FILE       = 'stopx.log',
     &     STATUS     = 'UNKNOWN')
C
c     CLOSE(UNIT=LOGUP,DISP='DELETE')
      CLOSE(UNIT=LOGUP)
C
      OPEN(UNIT       = LOGUP,
     &     FILE       = 'stopx.log',
     &     STATUS     = 'REPLACE')
C
      CALL HELPNIT(IHEPF)
C
      CALL CTCNIT
C
      RETURN
C
      END
